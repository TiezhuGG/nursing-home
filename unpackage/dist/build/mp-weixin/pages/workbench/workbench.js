(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/workbench/workbench"],{"0507":function(e,t,o){},5967:function(e,t,o){"use strict";o.r(t);var n=o("e6bb"),c=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,(function(){return n[e]}))}(i);t["default"]=c.a},"78bc":function(e,t,o){"use strict";o.r(t);var n=o("faf1"),c=o("5967");for(var i in c)"default"!==i&&function(e){o.d(t,e,(function(){return c[e]}))}(i);o("bfb4");var r,s=o("f0c5"),a=Object(s["a"])(c["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);t["default"]=a.exports},bfb4:function(e,t,o){"use strict";var n=o("0507"),c=o.n(n);c.a},c3f4:function(e,t,o){"use strict";(function(e){o("04ee"),o("921b");n(o("66fd"));var t=n(o("78bc"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},e6bb:function(e,t,o){"use strict";(function(e){function o(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=n(e))){var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i,r=!0,s=!1;return{s:function(){c=e[Symbol.iterator]()},n:function(){var e=c.next();return r=e.done,e},e:function(e){s=!0,i=e},f:function(){try{r||null==c.return||c.return()}finally{if(s)throw i}}}}function n(e,t){if(e){if("string"===typeof e)return c(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{nurseInfo:{},noticeList:[],isOpenBle:!1,devicesList:[],deviceId:"67:95:69:F9:B3:C5",serviceId:"",primaryUUID:"",characteristicId:{writeId:"",notifyId:""},pid:"",bpid:""}},onLoad:function(){e.removeStorageSync("pid"),e.removeStorageSync("bpid"),this.nurseInfo=e.getStorageSync("userInfo"),this.fetchNoticeList()},onShow:function(){},methods:{toHeartRate:function(){e.navigateTo({url:"../heart-rate/heart-rate?pid=".concat(this.pid)})},toBloodStatus:function(){e.navigateTo({url:"../blood-status/blood-status?bpid=".concat(this.bpid)})},initBluetoothAdapter:function(){var t=this;e.openBluetoothAdapter({success:function(e){console.log("初始化蓝牙成功",e.errMsg),t.isOpenBle=!0,t.searchBluetoothDevice()},fail:function(e){console.log("初始化蓝牙失败，错误码: (".concat(e.errCode," || ").concat(e.errMsg,")"))}}),this.onBLEConnectionStateChange()},searchBluetoothDevice:function(){var t=this;setTimeout((function(){t.isOpenBle?(console.log("开始搜索附近蓝牙智能设备"),e.startBluetoothDevicesDiscovery({success:function(e){t.findBluetoothDevice()},fail:function(t){console.log("查找设备失败!"),e.showToast({icon:"none",title:"查找设备失败！",duration:3e3})}})):console.log("未初始化蓝牙适配器, isOpenBle:".concat(t.isOpenBle))}),1e3)},findBluetoothDevice:function(){var t=this;console.log("监听寻找新设备"),e.onBluetoothDeviceFound((function(e){console.log("开始监听寻找到新设备的事件"),t.getBleDevices()}))},getBleDevices:function(){var t=this;console.log("获取蓝牙设备"),e.getBluetoothDevices({success:function(e){console.log(e),console.log("获取蓝牙设备成功: ".concat(e.errMsg)),t.devicesList=e.devices;var n,c=o(t.devicesList);try{for(c.s();!(n=c.n()).done;){var i=n.value;if(console.log(i.deviceId),i.deviceId==t.deviceId){console.log("找到蓝牙设备".concat(i.deviceId,"，开始连接~~~~~")),setTimeout((function(){t.getConnectBlue()}),1e3);break}}}catch(r){c.e(r)}finally{c.f()}},fail:function(e){console.log("获取蓝牙设备失败: ".concat(e.errMsg))}})},getConnectBlue:function(){var t=this;console.log("".concat(this.deviceId,"蓝牙设备连接中")),e.createBLEConnection({deviceId:this.deviceId,success:function(e){console.log("".concat(t.deviceId,"蓝牙设备连接成功")),t.getBLEDeviceServices(),t.stopDiscovery()},fail:function(o){console.log("蓝牙设备连接失败",o),e.closeBLEConnection({deviceId:t.deviceId,success:function(e){console.log("蓝牙设备连接断开, 正在重新连接"),t.getConnectBlue()}})}})},getBLEDeviceServices:function(){var t=this;console.log("正在获取蓝牙设备所有服务");var n=[];e.getBLEDeviceServices({deviceId:this.deviceId,success:function(e){n=e.services,console.log("获取蓝牙设备服务成功".concat(JSON.stringify(e.services)));var c,i=o(n);try{for(i.s();!(c=i.n()).done;){var r=c.value;if(console.log("service--".concat(r,"---serviceId-").concat(r.uuid)),-1!=r.uuid.indexOf(t.primaryUUID)){t.serviceId=r.uuid,console.log("设备的serviceId".concat(t.serviceId)),t.getBLEDeviceCharacteristics();break}}}catch(s){i.e(s)}finally{i.f()}t.getBLEDeviceCharacteristics()},fail:function(e){console.log("device services:",e.services)}})},getBLEDeviceCharacteristics:function(){var t=this;console.log("开始获取服务特征值");var n=[];e.getBLEDeviceCharacteristics({deviceId:this.deviceId,serviceId:this.serviceId,success:function(e){console.log("获取的".concat(t.serviceId,"服务的特征值").concat(JSON.stringify(e.characteristics))),n=e.characteristics;var c,i=o(n);try{for(i.s();!(c=i.n()).done;){var r=c.value;console.log("特征值".concat(JSON.stringify(r))),r.properties.notify&&(t.characteristicId.notifyId=r.uuid,console.log("notifyId值为：".concat(t.characteristicId.notifyId))),r.properties.write&&(t.characteristicId.writeId=r.uuid,console.log("writeId值为：".concat(t.characteristicId.writeId)))}}catch(s){i.e(s)}finally{i.f()}}})},notify:function(){var t=this;e.notifyBLECharacteristicValueChange({state:!0,deviceId:this.deviceId,serviceId:this.serviceId,characteristicId:this.characteristicId.notifyId,success:function(o){console.log("订阅特征值".concat(JSON.stringify(o))),e.onBLECharacteristicValueChange((function(e){console.log("监听低功耗蓝牙设备的特征值变化事件".concat(JSON.stringify(e))),console.log("".concat(e.characteristicId,"变化, 现在是{$JSON.stringify(res.value)}"));var o=t.ab2hex(e.value);console.log("value ---\x3e ".concat(o))}))}})},stopDiscovery:function(){e.stopBluetoothDevicesDiscovery({success:function(e){console.log("停止搜索蓝牙设备: ".concat(e.errMsg))},fail:function(e){console.log("停止搜索蓝牙设备失败，错误码: ".concat(e.errCode))}})},onBLEConnectionStateChange:function(){var t=this;e.onBLEConnectionStateChange((function(o){console.log("蓝牙连接状态".concat(JSON.stringify(o))),o.connected||(console.log("断开低功耗蓝牙成功~~"),e.closeBLEConnection({deviceId:t.deviceId,success:function(e){console.log("关闭蓝牙模块")}}))}))},ab2hex:function(e){var t=Array.prototype.map.call(new Uint8Array(e),(function(e){return("00"+e.toString(16)).slice(-2)}));return t.join("")},toNotice:function(t){e.navigateTo({url:"../notice/notice?id=".concat(t)})},fetchNoticeList:function(){var t=this;e.request({url:"https://ciai.le-cx.com/index.php/api/notice/noticeList",success:function(e){t.noticeList=e.data.data}})}}};t.default=i}).call(this,o("543d")["default"])},faf1:function(e,t,o){"use strict";var n,c=function(){var e=this,t=e.$createElement;e._self._c},i=[];o.d(t,"b",(function(){return c})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){return n}))}},[["c3f4","common/runtime","common/vendor"]]]);