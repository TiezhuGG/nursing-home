(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/blood-status/blood-status"],{"15ec":function(e,t,i){"use strict";var n=i("a250"),c=i.n(n);c.a},"334f":function(e,t,i){"use strict";var n,c=function(){var e=this,t=e.$createElement,n=(e._self._c,i("395c")),c=i("e73a"),a=i("9813"),o=i("e73a"),r=i("9813"),s=i("e73a"),u=i("9813");e.$mp.data=Object.assign({},{$root:{m0:n,m1:c,m2:a,m3:o,m4:r,m5:s,m6:u}})},a=[];i.d(t,"b",function(){return c}),i.d(t,"c",function(){return a}),i.d(t,"a",function(){return n})},"5dea":function(e,t,i){"use strict";i.r(t);var n=i("334f"),c=i("d6df");for(var a in c)"default"!==a&&function(e){i.d(t,e,function(){return c[e]})}(a);i("15ec");var o,r=i("f0c5"),s=Object(r["a"])(c["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],o);t["default"]=s.exports},a250:function(e,t,i){},c9a0:function(e,t,i){"use strict";(function(e){i("04ee"),i("921b");n(i("66fd"));var t=n(i("5dea"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("543d")["createPage"])},d660:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,c=o(i("a34a")),a=o(i("9591"));function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,i,n,c,a,o){try{var r=e[a](o),s=r.value}catch(u){return void i(u)}r.done?t(s):Promise.resolve(s).then(n,c)}function s(e){return function(){var t=this,i=arguments;return new Promise(function(n,c){var a=e.apply(t,i);function o(e){r(a,n,c,o,s,"next",e)}function s(e){r(a,n,c,o,s,"throw",e)}o(void 0)})}}var u=null,l={data:function(){return{navTitles:["血压","血氧","血糖"],currentIndex:0,cWidth:"",cHeight:"",pixelRatio:1,patientList:[],patient:null,bp_devices:[],bp_connected:!1,bp_chs:[],bp_discoveryStarted:!1,bp_canWrite:!1,bp_deviceId:"",bp_serviceId:"",bp_characteristicId:"",bp_list:[],bp_categories:[],bo_devices:[],bo_connected:!1,bo_chs:[],bo_discoveryStarted:!1,this_week:"6月7日-6月13日",avg_val_blood:"135/80",avg_val_time:65}},onLoad:function(){n=this,n.fetchPatientList(),this.getServerData(1),this.cWidth=e.upx2px(750),this.cHeight=e.upx2px(500)},methods:{bindPickerChange:function(e){var t=!0,i=!1,n=void 0;try{for(var c,a=this.patientList[Symbol.iterator]();!(t=(c=a.next()).done);t=!0){var o=c.value;o.id===Number(e.detail.value)+1&&this.fetchPatientInfo(o.id)}}catch(r){i=!0,n=r}finally{try{t||null==a.return||a.return()}finally{if(i)throw n}}},fetchPatientList:function(){var t=s(c.default.mark(function t(){var i=this;return c.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.request({url:"https://ciai.le-cx.com/index.php/api/patient/patientList",success:function(e){i.patientList=e.data.data}});case 2:case"end":return t.stop()}},t,this)}));function i(){return t.apply(this,arguments)}return i}(),fetchPatientInfo:function(){var t=s(c.default.mark(function t(i){var n=this;return c.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.request({url:"https://ciai.le-cx.com/index.php/api/patient/info?id=".concat(i),success:function(e){n.patient=e.data.data}});case 2:case"end":return t.stop()}},t,this)}));function i(e){return t.apply(this,arguments)}return i}(),switchTab:function(e){this.currentIndex=e,this.getServerData(this.currentIndex+1)},getServerData:function(t){e.request({url:"https://www.ucharts.cn/data.json",data:{},success:function(e){var i={categories:[],series:[]};i.categories=e.data.data.LineA.categories,i.series=[{data:[0,100,70,20,100,50],name:"aa"}],n.showLineA(t,i)},fail:function(){n.tips="网络错误，小程序端请检查合法域名"}})},showLineA:function(e,t){u=new a.default({$this:n,canvasId:e,type:"line",fontSize:11,colors:["#24C789"],legend:{show:!0},dataLabel:!1,dataPointShape:!0,background:"#FFFFFF",pixelRatio:n.pixelRatio,categories:t.categories,series:t.series,animation:!1,xAxis:{disableGrid:!0},yAxis:{data:[{axisLine:!1}],gridType:"dash",gridColor:"#CCC",dashLength:2,min:0,max:150,format:function(e){return e.toFixed(0)}},width:n.cWidth*n.pixelRatio,height:n.cHeight*n.pixelRatio,extra:{line:{type:"curve"}}})},touchLineA:function(e){u.showToolTip(e,{format:function(e,t){return t+" "+e.name+":"+e.data}})},inArray:function(e,t,i){for(var n=0;n<e.length;n++)if(e[n][t]===i)return n;return-1},ab2hex:function(e){var t=Array.prototype.map.call(new Uint8Array(e),function(e){return("00"+e.toString(16)).slice(-2)});return t.join("")},bp_openBluetoothAdapter:function(){var t=this;console.log("获取血压信息"),e.openBluetoothAdapter({success:function(e){console.log("openBluetoothAdapter success",e),t.bp_startBluetoothDevicesDiscovery()},fail:function(i){10001===i.errCode&&e.onBluetoothAdapterStateChange(function(e){e.available&&t.bp_startBluetoothDevicesDiscovery()})}})},bp_startBluetoothDevicesDiscovery:function(){var t=this;this.bp_discoveryStarted||(this.bp_discoveryStarted=!0,e.startBluetoothDevicesDiscovery({allowDuplicatesKey:!0,success:function(e){console.log("startBluetoothDevicesDiscovery success",e),t.bp_onBluetoothDeviceFound()}}))},bp_getBluetoothAdapterState:function(){var t=this;console.log("getBluetoothAdapterState"),e.getBluetoothAdapterState({success:function(e){console.log("getBluetoothAdapterState",e),e.discovering?t.bp_onBluetoothDeviceFound():e.available&&t.bp_startBluetoothDevicesDiscovery()}})},bp_onBluetoothDeviceFound:function(){var t=this;e.onBluetoothDeviceFound(function(e){var i=e.devices;if(console.log("devices",i),"FSRKB_BT_001"==i[0].name){var n=i[0];t.bp_createBLEConnection(n)}})},bp_stopBluetoothDevicesDiscovery:function(){e.stopBluetoothDevicesDiscovery()},bp_createBLEConnection:function(t){var i=this,n=t.deviceId;t.name;e.createBLEConnection({deviceId:n,success:function(e){i.bp_connected=!0,i.bp_getBLEDeviceServices(n)}}),this.bp_stopBluetoothDevicesDiscovery()},bp_closeBLEConnection:function(){e.closeBLEConnection({deviceId:this.data.deviceId}),this.setData({connected:!1,chs:[],canWrite:!1})},bp_getBLEDeviceServices:function(t){var i=this;e.getBLEDeviceServices({deviceId:t,success:function(e){for(var n=0;n<e.services.length;n++)if("0000FFF0-0000-1000-8000-00805F9B34FB"==e.services[n].uuid)return void i.bp_getBLEDeviceCharacteristics(t,e.services[n].uuid)}})},bp_getBLEDeviceCharacteristics:function(t,i){var n=this;e.getBLEDeviceCharacteristics({deviceId:t,serviceId:i,success:function(c){for(var a=0;a<c.characteristics.length;a++){var o=c.characteristics[a];"0000FFF6-0000-1000-8000-00805F9B34FB"==o.uuid&&(n.bp_canWrite=!0,n.bp_deviceId=t,n.bp_serviceId=i,n.bp_characteristicId=o.uuid,n.bp_writeBLECharacteristicValue(),e.notifyBLECharacteristicValueChange({deviceId:t,serviceId:i,characteristicId:o.uuid,state:!0}))}},fail:function(e){console.error("getBLEDeviceCharacteristics",e)}}),e.onBLECharacteristicValueChange(function(e){var t=ab2hex(e.value);if("cc"==t.substr(6,2))if("00"==t.substr(10,2))switch(parseInt(t.substr(8,2),16)){case 1:console.log("传感器异常！");break;case 2:console.log("不足以检测心跳或血压！");break;case 3:console.log("异常测量结果！");break;case 4:console.log("袖口太松或泄漏（10秒压力小于30毫米）");break;case 5:console.log("气管堵塞");break;case 6:console.log("压力波动过大");break;case 7:console.log("压力超过上限");break;case 8:console.log("请查看标准数据是否异常");break}else console.log("高压：",parseInt(t.substr(8,2),16),"低压：",parseInt(t.substr(10,2),16),"心率",parseInt(t.substr(12,2),16));else console.log("当前压力：",parseInt(t.substr(10,2),16))})},bp_writeBLECharacteristicValue:function(){for(var t=[190,176,1,192,54],i=new ArrayBuffer(5),n=new DataView(i),c=0;c<5;c++)n.setUint8(c,t[c]);console.log(i),e.writeBLECharacteristicValue({deviceId:this.bp_deviceId,serviceId:this.bp_serviceId,characteristicId:this.bp_characteristicId,value:i})},bp_closeBluetoothAdapter:function(){e.closeBluetoothAdapter(),this.bp_discoveryStarted=!1},getNowTime:function(){var e=new Date,t=e.getHours(),i=e.getMinutes(),n=e.getSeconds();t=t<10?"0"+t:t,i=i<10?"0"+i:i,n=n<10?"0"+n:n;var c="".concat(t,":").concat(i,":").concat(n);return c}}};t.default=l}).call(this,i("543d")["default"])},d6df:function(e,t,i){"use strict";i.r(t);var n=i("d660"),c=i.n(n);for(var a in n)"default"!==a&&function(e){i.d(t,e,function(){return n[e]})}(a);t["default"]=c.a}},[["c9a0","common/runtime","common/vendor"]]]);